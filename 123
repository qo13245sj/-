-- Robloxè½½å…·åŠ é€Ÿ - å¯ç§»åŠ¨æŒ‰é’®ç‰ˆ
-- æŒ‰ä½å±å¹•ä¸Šçš„æ­£æ–¹å½¢æŒ‰é’®æŒç»­åŠ é€Ÿ

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

-- ========== é…ç½®å‚æ•° ==========
local CONFIG = {
    -- é€Ÿåº¦è®¾ç½®
    BASE_SPEED = 50,
    MAX_SPEED = 180,
    
    -- åŠ é€Ÿè®¾ç½®
    BOOST_INCREMENT = 2,        -- æ¯ç§’å¢åŠ çš„é€Ÿåº¦
    MAX_BOOST_LEVEL = 100,      -- æœ€å¤§åŠ é€Ÿç­‰çº§
    BOOST_DECAY_RATE = 5,       -- æ¾å¼€æŒ‰é’®æ—¶æ¯ç§’è¡°å‡
    
    -- æŒ‰é’®è®¾ç½®
    BUTTON_SIZE = 70,           -- æŒ‰é’®å¤§å°(åƒç´ )
    BUTTON_COLOR = Color3.fromRGB(0, 150, 255),
    ACTIVE_COLOR = Color3.fromRGB(255, 100, 0),
    BUTTON_OPACITY = 0.7,
    
    -- ç‰©ç†è®¾ç½®
    BASE_TORQUE = 50000,
    BOOST_TORQUE = 75000,
    TURN_SPEED = 1.5
}

-- ========== å…¨å±€å˜é‡ ==========
local VehicleSystem = {
    Players = {},
    DragEnabled = false,
    ButtonDragging = false,
ButtonPositions={}
}

-- ========== åˆå§‹åŒ–å‡½æ•° ==========
function VehicleSystem.Init()
æ‰“å°("ğŸš— è½½å…·åŠ é€Ÿç³»ç»Ÿå¯åŠ¨ä¸­...")
    
-- ç©å®¶åŠ å…¥
players.PlayerAddedï¼šè¿æ¥(å‡½æ•°(æ’­æ”¾å™¨)
VehicleSystem.SetupPlayer(æ’­æ”¾å™¨)
ç»“æŸ)
    
-- ç©å®¶ç¦»å¼€
æ’­æ”¾å™¨ã€‚æ’­æ”¾å™¨ç§»é™¤ï¼šè¿æ¥(åŠŸèƒ½(æ’­æ”¾å™¨)
VehicleSystem.CleanupPlayer(æ’­æ”¾å™¨)
ç»“æŸ)
    
-- ä¸ºå·²å­˜åœ¨çš„ç©å®¶åˆå§‹åŒ–
å¯¹äº_ï¼Œipairsä¸­çš„player(players:GetPlayers())do
VehicleSystem.SetupPlayer(æ’­æ”¾å™¨)
ç»“æŸ
    
-- å¯åŠ¨å¾ªç¯
VehicleSystem.StartUpdateLoop()
    
æ‰“å°("âœ… è½½å…·åŠ é€Ÿç³»ç»Ÿå·²å¯åŠ¨")
ç»“æŸ

-- ========== ç©å®¶è®¾ç½® ==========
åŠŸèƒ½è½¦è¾†ç³»ç»Ÿ.SetupPlayer(æ’­æ”¾å™¨)
å¦‚æœVehicleSystem.Players[player]ï¼Œåˆ™è¿”å›ç»“æŸ
    
æœ¬åœ°çŠ¶æ€={
InVehicle=falseï¼Œ
è½¦è¾†=é›¶ï¼Œ
DriveSeat=é›¶ï¼Œ
BoostLevel=0ï¼Œ
IsBoosting=falseï¼Œ
ButtonPressed=falseï¼Œ
ButtonHeldTime=0ï¼Œ
GUI=é›¶ï¼Œ
connections={}
    }
    
VehicleSystem.Players[player]=çŠ¶æ€
    
-- è§’è‰²åŠ è½½
è¿åŠ¨å‘˜ã€‚CharacterAdded:Connect(å‡½æ•°(å­—ç¬¦)
è½¦è¾†ç³»ç»Ÿ.æ£€æŸ¥è½¦è¾†(è§’è‰²ï¼Œæ’­æ”¾å™¨)
ç»“æŸ)
    
-- å·²æœ‰è§’è‰²
å¦‚æœæ’­æ”¾å™¨.å­—ç¬¦ï¼Œåˆ™
task.wait(1)
è½¦è¾†ç³»ç»Ÿ.æ£€æŸ¥è½¦è¾†(æ’­æ”¾å™¨.å­—ç¬¦ï¼Œæ’­æ”¾å™¨)
ç»“æŸ
    
--åˆ›å»ºGUI(é¢„åˆ›å»º)
state.GUI=VehicleSystem.CreateBoostButton(æ’­æ”¾å™¨)
ç»“æŸ

-- ========== åˆ›å»ºå¯ç§»åŠ¨åŠ é€ŸæŒ‰é’® ==========
åŠŸèƒ½è½¦è¾†ç³»ç»Ÿ.CreateBoostButton(æ’­æ”¾å™¨)
æœ¬åœ°playerGui=player:WaitForChild("PlayerGui")
    
--åˆ›å»ºScreenGui
æœ¬åœ°screenGui=Instance.new("ScreenGui")
screenGui.Name="è½¦è¾†åŠ©åŠ›æŒ‰é’®"
screenGui.ResetOnSpawn=false
screenGui.ZIndexBehavior=æšä¸¾.ZIndexBehavior.Sibling
screenGui.Enabled=false
screenGui.Parent=playerGui
    
-- æŒ‰é’®å®¹å™¨ï¼ˆç”¨äºæ‹–åŠ¨ï¼‰
æœ¬åœ°æŒ‰é’®Container=Instance.new("Frame")
    buttonContainer.Name = "BoostButtonContainer"
    buttonContainer.Size = UDim2.new(0, CONFIG.BUTTON_SIZE + 20, 0, CONFIG.BUTTON_SIZE + 20)
    buttonContainer.Position = UDim2.new(0.8, 0, 0.7, 0)  -- é»˜è®¤ä½ç½®ï¼šå³ä¸‹è§’
    buttonContainer.BackgroundTransparency = 1
    buttonContainer.Parent = screenGui
    
    -- æŒ‰é’®èƒŒæ™¯ï¼ˆå¯æ‹–åŠ¨çš„åŒºåŸŸï¼‰
    local buttonBackground = Instance.new("Frame")
    buttonBackground.Name = "ButtonBackground"
    buttonBackground.Size = UDim2.new(1, 0, 1, 0)
    buttonBackground.Position = UDim2.new(0, 0, 0, 0)
    buttonBackground.BackgroundTransparency = 1
    buttonBackground.Parent = buttonContainer
    
    -- å¯æ‹–åŠ¨åŒºåŸŸ
    local dragFrame = Instance.new("Frame")
    dragFrame.Name = "DragFrame"
    dragFrame.Size = UDim2.new(1, 0, 0.2, 0)
    dragFrame.Position = UDim2.new(0, 0, 0, 0)
    dragFrame.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
    dragFrame.BackgroundTransparency = 0.9
    dragFrame.BorderSizePixel = 0
    dragFrame.Parent = buttonBackground
    
    local dragCorner = Instance.new("UICorner")
    dragCorner.CornerRadius = UDim.new(0, 8)
    dragCorner.Parent = dragFrame
    
    local dragLabel = Instance.new("TextLabel")
    dragLabel.Name = "DragLabel"
    dragLabel.Size = UDim2.new(1, 0, 1, 0)
    dragLabel.Position = UDim2.new(0, 0, 0, 0)
    dragLabel.BackgroundTransparency = 1
    dragLabel.Text = "â¬ æ‹–åŠ¨æ­¤å¤„"
    dragLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
    dragLabel.TextSize = 10
    dragLabel.Font = Enum.Font.Gotham
dragLabel.TextXAlignment=æšä¸¾.TextXAlignment.Center
dragLabel.Parent=dragframe
    
-- ä¸»æŒ‰é’®ï¼ˆæ­£æ–¹å½¢ï¼‰
æœ¬åœ°boostButton=Instance.new("TextButton")
boostButton.Name="BoostButton"
boostButton.Size=UDim2.new(0ï¼ŒCONFIG.BUTTON_SIZEï¼Œ0ï¼ŒCONFIG.BUTTON_SIZE)
boostButton.Position=UDim2.new(0.5ï¼Œ-CONFIG.BUTTON_SIZE/2ï¼Œ0.2ï¼Œ0)
boostButton.AnchorPoint=Vector2.new(0.5ï¼Œ0)
boostButton.BackgroundColor3=CONFIG.BUTTON_COLOR
boostButton.BackgroundTransparency=CONFIG.BUTTON_OPACITY
boostButton.BorderSizePixel=0
boostButton.Text="æŒ‰ä½åŠ é€Ÿ"
boostButton.TextColor3=Color3.fromRGB(255ï¼Œ255ï¼Œ255)
boostButton.TextSize=14
boostButton.Font=æšä¸¾.Font.GothamBold
boostButton.AutoButtonColor=false
boostButton.Parent=buttonBackground
    
-- æŒ‰é’®åœ†è§’
æœ¬åœ°buttonCorner=Instance.new("UICorner")
buttonCorner.CornerRadius=UDim.new(0ï¼Œ12)
buttonCorner.Parent=boostButton
    
-- æŒ‰é’®è¾¹æ¡†
æœ¬åœ°buttonStroke=Instance.new("UIStroke")
buttonStroke.Color=Color3.fromRGB(255ï¼Œ255ï¼Œ255)
buttonStroke.Thickness=2.5
    buttonStroke.Parent = boostButton
    
    -- æŒ‰é’®å‘å…‰æ•ˆæœ
    local buttonGlow = Instance.new("UIStroke")
    buttonGlow.Name = "ButtonGlow"
    buttonGlow.Color = CONFIG.BUTTON_COLOR
    buttonGlow.Thickness = 0
    buttonGlow.Transparency = 0.5
    buttonGlow.Parent = boostButton
    
    -- è¿›åº¦æŒ‡ç¤ºå™¨ï¼ˆåœ†å½¢ï¼‰
    local progressIndicator = Instance.new("Frame")
    progressIndicator.Name = "ProgressIndicator"
    progressIndicator.Size = UDim2.new(1, -20, 1, -20)
    progressIndicator.Position = UDim2.new(0, 10, 0, 10)
    progressIndicator.BackgroundTransparency = 1
    progressIndicator.Parent = boostButton
    
    local progressCorner = Instance.new("UICorner")
    progressCorner.CornerRadius = UDim.new(1, 0)
    progressCorner.Parent = progressIndicator
    
    local progressStroke = Instance.new("UIStroke")
    progressStroke.Name = "ProgressStroke"
    progressStroke.Color = Color3.fromRGB(255, 255, 255)
    progressStroke.Thickness = 3
    progressStroke.Transparency = 0.3
    progressStroke.Parent = progressIndicator
    
    -- é€Ÿåº¦æŒ‡ç¤ºæ–‡æœ¬
    local speedText = Instance.new("TextLabel")
    speedText.Name = "SpeedText"
    speedText.Size = UDim2.new(1, 0, 0, 40)
    speedText.Position = UDim2.new(0, 0, 0, CONFIG.BUTTON_SIZE + 5)
    speedText.BackgroundTransparency = 1
    speedText.Text = "0%"
    speedText.TextColor3 = Color3.fromRGB(255, 255, 255)
    speedText.TextSize = 16
    speedText.Font = Enum.Font.GothamBold
    speedText.Parent = buttonBackground
    
    -- ========== æŒ‰é’®æ‹–åŠ¨é€»è¾‘ ==========
    local isDragging = false
    local dragStartPos, buttonStartPos
    
    -- å¼€å§‹æ‹–åŠ¨
    dragFrame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or 
           input.UserInputType == Enum.UserInputType.Touch then
            isDragging = true
            dragStartPos = input.Position
            buttonStartPos = buttonContainer.Position
            
            -- è§†è§‰åé¦ˆ
            dragFrame.BackgroundTransparency = 0.7
        end
    end)
    
    -- æ‹–åŠ¨ä¸­
    UserInputService.InputChanged:Connect(function(input)
        if isDragging and (input.UserInputType == Enum.UserInputType.MouseMovement or 
                          input.UserInputType == Enum.UserInputType.Touch) then
            local delta = input.Position - dragStartPos
            local newPos = UDim2.new(
                buttonStartPos.X.Scale,
                buttonStartPos.X.Offset + delta.X,
                buttonStartPos.Y.Scale,
                buttonStartPos.Y.Offset + delta.Y
            )
            
            -- é™åˆ¶åœ¨å±å¹•å†…
            local screenSize = playerGui.AbsoluteSize
            local buttonSize = buttonContainer.AbsoluteSize
            
            local minX = 0
            local maxX = screenSize.X - buttonSize.X
            local minY = 0
            local maxY = screenSize.Y - buttonSize.Y
            
            local absX = buttonStartPos.X.Offset + delta.X
            local absY = buttonStartPos.Y.Offset + delta.Y
            
            absX = math.clamp(absX, minX, maxX)
            absY = math.clamp(absY, minY, maxY)
            
            buttonContainer.Position = UDim2.new(0, absX, 0, absY)
        end
    end)
    
    -- ç»“æŸæ‹–åŠ¨
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or 
           input.UserInputType == Enum.UserInputType.Touch then
            if isDragging then
                isDragging = false
                dragFrame.BackgroundTransparency = 0.9
                
                -- ä¿å­˜ä½ç½®
                VehicleSystem.ButtonPositions[player] = buttonContainer.Position
            end
        end
    end)
    
    -- ========== åŠ é€ŸæŒ‰é’®é€»è¾‘ ==========
    local isButtonPressed = false
    local pressStartTime = 0
    
    -- æŒ‰ä¸‹æŒ‰é’®
    boostButton.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or 
           input.UserInputType == Enum.UserInputType.Touch then
            if not VehicleSystem.Players[player].InVehicle then return end
            
            isButtonPressed = true
            pressStartTime = tick()
            VehicleSystem.Players[player].ButtonPressed = true
            VehicleSystem.Players[player].IsBoosting = true
            
            -- è§†è§‰åé¦ˆ
            boostButton.BackgroundColor3 = CONFIG.ACTIVE_COLOR
            buttonGlow.Color = CONFIG.ACTIVE_COLOR
            buttonGlow.Thickness = 5
            
            -- æŒ‰é’®ç¼©æ”¾åŠ¨ç”»
            local tweenInfo = TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
            local tween = TweenService:Create(boostButto
